<% provide(:title, @user.name) %>
<div class="row">
  <aside class="col-md-4">
    <section class="user_info">
        <%= gravatar_for @user, size: 50 %>
        <h1><%= @user.name %></h1>
        <% if @user == current_user %>
        	<span><%= link_to "update my profile", edit_user_path(current_user) %></span>
         <% else %>
         <br>
         <% end %>
        <span></span>
    </section>
    <section class="room_info">
		<% if current_user.rooms.any? %>
			<%= render 'shared/room_info' %>
		<% else %>
			<p>You are not a member of any rooms at the moment. Create a new room and ask your friends to join it or join one of the exsiting rooms!</p>
		<% end %>
    </section>
	</aside>
	<div class="col-md-8">
	<section class="product_info">
	<% if @user == current_user %>
		<h1>My Products</h1>
	<% else %>
		<h1>Products by <%= @user.name %></h1>
	<% end %>
		<% if @user.products.any? %>
			<p>Number of products: <%= @user.products.count %></p>
			<% user_products = @user.products %>
			<p>Total Cost: <span class="product_price"><%= number_to_currency(@user.products.sum(:price), :unit => "€") %></span></p>
			<ol>
				<% @user.products.reverse_each do |product| %>
					<li>
						<p class="product_name">
							<%= product.name  %>  
							<span class="product_price">
								<%= number_to_currency(product.price, :unit => "€") %>
							</span>
						</p>
						<% unless product.description == "" %>
							<p class="product_description">(<%= product.description %>)</p>
						<% end %>
						<p class="product_date_author"><%= product.created_at.strftime('%b %d, %Y') %> | by <%= User.find(product.user_id).name %></p>
						<% if @user || current_user.try(:admin?) %>
							<p class="product_buttons">
							<%= link_to "Edit", edit_product_path(product.id), class: "btn btn-default btn-xs" %>
							<%= link_to "Delete", product_path(product.id), class: "btn btn-default btn-xs", method: :delete, data: { confirm: "You sure?" } %>
							</p>
						<br>
						<% end %>
					</li>
				<% end %>
			</ol>
		<% else %>
			<p>No products yet.</p>
		<% end %>
	</section>
	</div>
</div>

